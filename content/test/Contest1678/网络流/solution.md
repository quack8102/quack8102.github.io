

# Problem C: 网络流 - solution

  
  
## T3  
  
\---  
  
### 算法1  
  
写了一发网络流暴力扔了上去。  
  
得分不明。  
  
\---  
  
### 算法2  
  
观察性质  
  
$f(i,j)>max(f(i-1,j),f(i,j+1))$  
  
这提示我们答案是一个递减函数。  
  
考虑计算有多少个使得答案$\geq a$的$f(i,j)$  
  
预处理出来对于每个$i$，左边选择集合$j$，右边选择集合$k$，是否存在可行流。  
  
时间复杂度$O(\frac{nk8^k}{w})$。  
  
\---  
  
### 算法3  
  
仍然考虑计数问题。  
  
不同的是我们设一点状态。  
  
设$g(i,j)$表示考虑$i \sim n+1$层，从状态$j$出发，最多能转移到哪一层。  
  
我们再次考虑一下[Hall定理](https://baike.baidu.com/item/Hall%E5%AE%9A%E7%90%86/5111749?fr=aladdin)。  
  
根据Hall定理我们可以得到如下转移方式:  
  
\---  
  
枚举每一个子集$S$，找到其相邻的点集$T$。对于每个$T$的大小为$|S|$的子集$U$,求$g(i+1,U)$的最大值，设为$h(S)$  
  
则$g(i,S)$为$min \left\\{ h(T),T \subset S \right\\}$  
  
正确性可以通过枚举时间设置0/1状态得到  
  
单次转移复杂度$O(2^k*k^2)$  
  
总复杂度$O(n*2^k*k^2)$  
  
\---  
  
### 算法4  
  
Hall定理看上去优化不了了。  
  
回到最初的网络流建图模型上来。  
  
如果我们只需要计算$f(1,i)$则只需要从第一层出发流尽量长的流即可。这样子跑网络流显然正确  
  
同时我们可以直接从跑完第一层的残量网络继承过来直接计算第二层的流！  
  
\---  
  
考虑在第二层的额外扩展的流，若其比第一层扩展的优秀而没有被扩展，说明这个流在第一层无法被扩展，不会被相对的贪心顺序影响。  
  
否则这一条流显然没有第一层拓展的优秀，符合贪心策略。  
  
由于寻找一次长度为$p$的流的复杂度为$O(p*k^2)$，总流量为$O(n*k)$，所以总复杂度为$O(n*k^3)$  
  
可以通过某些操作使得复杂度变为$O(n*k^3/w)$  
  
\---  
  
  

