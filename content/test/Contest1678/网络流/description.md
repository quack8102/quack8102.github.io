

# Problem C: 网络流

Time Limit: 3000 ms Memory Limit: 512 MB

## Description

# 网络流(flow)  
  
### 题目描述  
  
asugongshang打算教教他们网络流的正确姿势。  
  
他从网上找了这么一道标签里包含网络流的题目:  
  
WZYYN有一张$n \times k$个节点的图，节点总共分为$n$层，每层$k$个。为了方便描述，之后我们称第$i$层第$j$个点为$(i,j)$。  
  
这张图非常特殊，$\forall i \in [1,n-1]$，有且仅有连接从第$i$层出发，终止于第$i+1$层的单向通道。  
  
WZYYN想要在这张图上存储某些信息。每条信息长度均为n。  
  
WZYYN需要找到一个仅包含$[1,k]$的长度为$n$的序列$a$使得$\forall
i∈[1,n-1]$,存在$(i,a_i)$到$(i+1,a_{i+1})$的单向路径。  
  
WZYYN可以在这条路径的所有节点上存储恰好一条信息。同时，不同信息不能存储在相同节点上，也就是说，一个节点最多只能被使用一次。  
  
WZYYN想要知道这张图上最多能存储几条信息。  
  
asugongshang觉得这道题非常傻逼于是把他加强了一下:  
  
设$f(i,j)$表示选出原图中的第$i$层至第$j$层节点的子图，最多能存储的长度为$j-i+1$的信息数量。  
  
asugongshang想要知道$\sum \limits_{i=1}^{n-1} \sum \limits_{j=i+1}^{n} f(i,j)$。  
  
### 输入格式  
  
从 ```flow.in``` 中读入数据。  
  
第一行两个正整数$n,k$。  
  
接下来$n-1$个$k$行$k$列的01矩阵，矩阵之间用空行分隔。  
  
对于第$i$个矩阵，若存在$(i,j)$至$(i+1,k)$的单向边，则第$j$行第$k$个元素为$1$，否则第$j$行第$k$个元素为$0$.  
  
### 输出格式  
  
向 ```flow.out``` 中读入数据。  
  
一行一个数字表示答案。  
  
### 样例  
  
#### 样例1输入  
  
```  
4 4  
1000  
1100  
0110  
0011  
  
0100  
1100  
0010  
0001  
  
1000  
1100  
0000  
0011  
```  
  
#### 样例1输出  
  
```  
21  
```  
  
#### 样例1解释  
  
$f(1,2)=f(1,3)=f(2,3)=4$  
  
$f(1,4)=f(2,4)=f(3,4)=3$  
  
### 数据范围  
  
| 数据点编号 | $n \le$ | $k \le$ |  
| :--: | :--: | :--: |  
| $1 \sim 2$ | $10$ | $10$ |  
| $3 \sim 4$ | $100$ | $10$ |  
| $5 \sim 6$ | $1000$ | $10$ |  
| $7$ | $40000$ | $1$ |  
| $8 \sim 9$ | $40000$ | $2$ |  
| $10 \sim 11$ | $40000$ | $3$ |  
| $12 \sim 13$ | $40000$ | $4$ |  
| $14 \sim 15$ | $40000$ | $5$ |  
| $16 \sim 17$ | $40000$ | $6$ |  
| $18 \sim 19$ | $40000$ | $7$ |  
| $20 \sim 21$ | $40000$ | $8$ |  
| $22 \sim 23$ | $40000$ | $9$ |  
| $24 \sim 25$ | $40000$ | $10$ |  
  
对于 $100\%$ 的数据，$1 \le n \le 40000,1 \le k \le 10$。  
  
时间限制：$\texttt{3S}$  
  
空间限制：$\texttt{512MB}$  

